<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>pm2-meteor by andruschka</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>pm2-meteor</h1>
        <h2>Simplest way to deploy, scale and run Meteor Apps with PM2.</h2>

        <section id="downloads">
          <a href="https://github.com/andruschka/pm2-meteor/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/andruschka/pm2-meteor/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/andruschka/pm2-meteor" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">

      <!-- START -->

      <h1 id="how-to-deploy-1-3-meteor-apps-with-pm2-meteor">How to deploy Meteor Apps with <br><code>pm2-meteor</code></h1>
      <p>This is a short tutorial for deploying your Meteor applications.
      (We are using Amazon EC2 with node v5.11.1. and the newest Meteor release - July 2016)
      I am the creator of pm2-meteor and this is only how I setup my Meteor machines. So this doesn&#39;t mean that it is the correct way for everybody.</p>
      <h2 id="step-one-prepare-your-machine-on-host">Step one (prepare your machine) - on host</h2>
      <ul>
      <li>Skip, if you have nodejs + npm + pm2 on your host machine</li>
      <li>First you should log in to your machine and install nodejs and npm.  <pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;ssh&nbsp;host</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;sudo&nbsp;apt-get&nbsp;install&nbsp;nodejs</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;sudo&nbsp;apt-get&nbsp;install&nbsp;npm</span></span></div></pre>
      </li>
      <li>Install pm2<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;sudo&nbsp;npm&nbsp;i&nbsp;-g&nbsp;pm2</span></span></span></div></pre></li>
      <li>Install nginx<pre class="editor-colors lang-text"><div class="line"><span class="text plain"><span class="meta paragraph text"><span>$&nbsp;sudo&nbsp;apt-get&nbsp;install&nbsp;nginx</span></span></span></div></pre></li>
      </ul>
      <h2 id="step-two-prepare-nginx-on-host">Step two (prepare nginx) - on host</h2>
      <ul>
      <li>Edit your nginx config to use ssl and redirecting to your Meteor Port
      (people often ask if pm2-meteor can deploy with ssl - no! You should configure your nginx to use ssl - I don&#39;t think this is a job for a deployment tool)</li>
      <li>Read step one of <a href="https://www.digitalocean.com/community/tutorials/how-to-deploy-a-meteor-js-application-on-ubuntu-14-04-with-nginx">this</a> for configuring nginx for Meteor Apps WITH SSL</li>
      </ul>
      <h2 id="step-three-prepare-mongodb-on-host">Step three (prepare mongodb) - on host</h2>
      <ul>
      <li>Skip if you already have a MongoDB</li>
      <li>Read step two of   <a href="https://www.digitalocean.com/community/tutorials/how-to-deploy-a-meteor-js-application-on-ubuntu-14-04-with-nginx">this</a> for setting up a MongoDB</li>
      </ul>
      <h2 id="step-four-prepare-your-app-on-local">Step four (prepare your app) - on local</h2>
      <ul>
      <li>Install pm2-meteor on your local machine<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;npm&nbsp;i&nbsp;pm2-meteor&nbsp;-g</span></span></div></pre>
      </li>
      <li>Go to the root of your app and create a (hidden) deployment folder (This is not a common convention - this is just how I store my pm2-meteor.json files. You also could create a common deployment folder for all your apps or just use your desktop folder I don&#39;t care ;-) )<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;</span><span class="support function builtin shell"><span>cd</span></span><span>&nbsp;Workspace/abc/meteor-app</span></span></div><div class="line"><span class="source shell"><span>$&nbsp;mkdir&nbsp;.deployment&nbsp;</span><span class="keyword operator list shell"><span>&amp;&amp;</span></span><span>&nbsp;</span><span class="support function builtin shell"><span>cd</span></span><span>&nbsp;.deployment</span></span></div></pre>
      </li>
      <li>Init a pm2-meteor settings file<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;pm2-meteor&nbsp;init</span></span></div></pre>
      </li>
      <li>Edit the created pm2-meteor.json in the .deployment folder  <pre class="editor-colors lang-javascript"><div class="line"><span class="source js"><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>appName</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>ninja-app</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>appLocation</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;Path&nbsp;to&nbsp;your&nbsp;app</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>local</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>~/Workspace/company/ninja-app</span><span class="punctuation definition string end js"><span>&quot;</span></span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;Path&nbsp;to&nbsp;the&nbsp;meteor&nbsp;settings</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>meteorSettingsLocation</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>~/Workspace/company/ninja-app/settings.json</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>meteorBuildFlags</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>--architecture&nbsp;os.linux.x86_64</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>env</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>ROOT_URL</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span class="markup underline link https hyperlink"><span>https://the-app-url.com</span></span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>PORT</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>3002</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>MONGO_URL</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>mongodb://mongodbuser:thepassword@mongourlOrIP:27017/ninjaApp</span><span class="punctuation definition string end js"><span>&quot;</span></span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>server</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="meta brace curly js"><span>{</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>host</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>my-host.com</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>username</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>ubuntu</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span class="punctuation whitespace comment leading js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line double-slash js"><span class="punctuation definition comment js"><span>//</span></span><span>&nbsp;I&nbsp;don&#39;t&nbsp;use&nbsp;passwords&nbsp;...</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>pem</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>~/.ssh/my-key.pem</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>deploymentDir</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>/home/ubuntu/meteor-apps</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>loadProfile</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>exec_mode</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>cluster_mode</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="meta delimiter object comma js"><span>,</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double js"><span class="punctuation definition string begin js"><span>&quot;</span></span><span>instances</span><span class="punctuation definition string end js"><span>&quot;</span></span></span><span class="keyword operator assignment js"><span>:</span></span><span>&nbsp;</span><span class="constant numeric decimal js"><span>2</span></span></span></div><div class="line"><span class="source js"><span>&nbsp;&nbsp;</span><span class="meta brace curly js"><span>}</span></span></span></div><div class="line"><span class="source js"><span class="meta brace curly js"><span>}</span></span></span></div></pre>
      </li>
      <li>Don&#39;t forget to add .deployment to your .gitignore file !!!</li>
      </ul>
      <h2 id="step-five-deploy-on-local">Step five (deploy) - on local</h2>
      <ul>
      <li>In the .deployment folder just run:<pre class="editor-colors lang-bash"><div class="line"><span class="source shell"><span>$&nbsp;pm2-meteor&nbsp;deploy</span></span></div></pre>
      </li>
      <li>That&#39;s it - now every time you make changes to your app, just go into the .deployment folder and run <code>$ pm2-meteor deploy</code>. Or you could write a script in package.json e.g. <code>&quot;push-deploy&quot;: &quot;cd .deployment &amp;&amp; pm2-meteor deploy&quot;</code>.</li>
      </ul>
      <hr>

      <h4 id="if-you-need-consulting-or-help-with-your-meteor-nodejs-apps-contact-me-via-my-homepage-betawerk-co-http-betawerk-co-">If you need consulting or help with your Meteor/nodejs apps contact me via my homepage <a href="http://betawerk.co">betawerk.co</a> - I know it is in German - multi lang support coming soon :-D</h4>

      <!-- .END -->


      </section>
    </div>


  </body>
</html>
